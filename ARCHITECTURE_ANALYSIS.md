# üèóÔ∏è –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –ê–†–•–ò–¢–ï–ö–¢–£–†–´ DC CIRCUIT ANALYSIS

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](#–æ–±–∑–æ—Ä-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)
2. [–ú–æ–¥—É–ª–∏ dc_circuit/](#–º–æ–¥—É–ª–∏-dc_circuit)
3. [–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–æ–¥—É–ª–µ–π](#–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ-–º–æ–¥—É–ª–µ–π)
4. [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ rl_trainer.py](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–≤-rl_trainerpy)
5. [–ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã](#–Ω–∞–π–¥–µ–Ω–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã)
6. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

---

## –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –°–ª–æ–∏—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  training/rl_trainer.py (GRPO –æ–±—É—á–µ–Ω–∏–µ)                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  dc_circuit/ (–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ —Ü–µ–ø–µ–π)                     ‚îÇ
‚îÇ  ‚îú‚îÄ game.py           (–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä)                         ‚îÇ
‚îÇ  ‚îú‚îÄ generator.py      (–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ü–µ–ø–µ–π)                     ‚îÇ
‚îÇ  ‚îú‚îÄ solver.py         (–§–∏–∑–∏–∫–∞: –ö–∏—Ä—Ö–≥–æ—Ñ)                     ‚îÇ
‚îÇ  ‚îú‚îÄ calculators.py    (Strategy: 8 —Ç–∏–ø–æ–≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π)        ‚îÇ
‚îÇ  ‚îú‚îÄ verifier.py       (–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ—Ü–µ–Ω–∫–∞)                   ‚îÇ
‚îÇ  ‚îî‚îÄ prompt.py         (–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è LLM)              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  base/ (–ê–±—Å—Ç—Ä–∞–∫—Ü–∏–∏)                                         ‚îÇ
‚îÇ  ‚îú‚îÄ game.py           (ABC Game)                            ‚îÇ
‚îÇ  ‚îú‚îÄ verifier.py       (ABC Verifier)                        ‚îÇ
‚îÇ  ‚îú‚îÄ data.py           (Data class)                          ‚îÇ
‚îÇ  ‚îî‚îÄ utils.py          (extract_answer, get_system_prompt)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

1. **Strategy Pattern** (calculators.py)
   - 8 —Ä–∞–∑–Ω—ã—Ö –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤
   - –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π

2. **Dependency Injection**
   - solver –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ calculators
   - verifier –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ trainer

3. **Single Responsibility**
   - –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –¥–µ–ª–∞–µ—Ç –æ–¥–Ω—É –≤–µ—â—å

---

## –ú–æ–¥—É–ª–∏ dc_circuit/

### 1. solver.py (–ë–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å)

#### –ö–ª–∞—Å—Å: Circuit
```python
class Circuit:
    """–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫—É—é —Ü–µ–ø—å"""
    def __init__(self):
        self.nodes = {}                  # node_id -> voltage
        self.resistors = {}              # (node1, node2) -> resistance
        self.voltage_sources = {}        # (pos, neg) -> voltage
        self.ground_node = None
```

**–ú–µ—Ç–æ–¥—ã:**
- `add_resistor(node1, node2, resistance)` - –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–∑–∏—Å—Ç–æ—Ä
- `add_voltage_source(pos, neg, voltage)` - –¥–æ–±–∞–≤–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫
- `set_ground(node)` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–µ–º–ª—é

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ü–µ–ø–∏

#### –ö–ª–∞—Å—Å: CircuitSolver
```python
class CircuitSolver:
    """–†–µ—à–∞–µ—Ç —Ü–µ–ø–∏ –º–µ—Ç–æ–¥–æ–º —É–∑–ª–æ–≤—ã—Ö –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤"""
    def solve(circuit: Circuit) -> Dict[str, float]:
        # –°—Ç—Ä–æ–∏—Ç –º–∞—Ç—Ä–∏—Ü—É –ø—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç–µ–π G
        # –†–µ—à–∞–µ—Ç G * V = I
        # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∑–ª–æ–≤—ã–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—ã
```

**–ú–µ—Ç–æ–¥—ã:**
- `solve(circuit)` ‚Üí Dict[node: voltage] - —Ä–µ—à–∏—Ç—å —Ü–µ–ø—å
- `get_current(circuit, voltages, n1, n2)` ‚Üí float - —Ç–æ–∫ —á–µ—Ä–µ–∑ —Ä–µ–∑–∏—Å—Ç–æ—Ä

**–§–∏–∑–∏–∫–∞:**
```python
# –ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç–µ–π:
G[i,i] += 1/R  # –î–∏–∞–≥–æ–Ω–∞–ª—å: —Å—É–º–º–∞ –ø—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç–µ–π —É–∑–ª–∞
G[i,j] -= 1/R  # –í–Ω–µ–¥–∏–∞–≥–æ–Ω–∞–ª—å: —Å–≤—è–∑–∏ –º–µ–∂–¥—É —É–∑–ª–∞–º–∏

# –°–∏—Å—Ç–µ–º–∞ —É—Ä–∞–≤–Ω–µ–Ω–∏–π:
G * V = I

# –ó–∞–∫–æ–Ω –û–º–∞:
I = (V1 - V2) / R
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ—à–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É —É—Ä–∞–≤–Ω–µ–Ω–∏–π –ö–∏—Ä—Ö–≥–æ—Ñ–∞

---

### 2. calculators.py (Strategy Pattern)

#### –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å: AnswerCalculator
```python
class AnswerCalculator(ABC):
    def __init__(self, solver: CircuitSolver, precision: int = 3):
        self.solver = solver
        self.precision = precision
    
    @abstractmethod
    def calculate(
        circuit: Circuit,
        node_voltages: Dict[str, float],
        metadata: Dict,
        target_resistor: str
    ) -> Optional[float]:
        pass
```

#### 8 –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–≤:

| # | –ö–ª–∞—Å—Å | –§–æ—Ä–º—É–ª–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|---|-------|---------|------------|
| 1 | `CurrentCalculator` | I = (V1-V2)/R | –¢–æ–∫ —á–µ—Ä–µ–∑ —Ä–µ–∑–∏—Å—Ç–æ—Ä |
| 2 | `VoltageCalculator` | V = I√óR | –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∑–∏—Å—Ç–æ—Ä–µ |
| 3 | `PowerCalculator` | P = I¬≤R | –ú–æ—â–Ω–æ—Å—Ç—å —Ä–µ–∑–∏—Å—Ç–æ—Ä–∞ |
| 4 | `TotalCurrentCalculator` | I_total | –¢–æ–∫ –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ |
| 5 | `EquivalentResistanceCalculator` | R_eq = V/I | –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ |
| 6 | `VoltageDividerCalculator` | V_R = V√ó(R/R_total) | –î–µ–ª–∏—Ç–µ–ª—å –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è |
| 7 | `CurrentDividerCalculator` | I_R = I√ó(G/G_total) | –î–µ–ª–∏—Ç–µ–ª—å —Ç–æ–∫–∞ |
| 8 | `TotalPowerCalculator` | P_total = Œ£(I¬≤R) | –û–±—â–∞—è –º–æ—â–Ω–æ—Å—Ç—å |

#### –§—É–Ω–∫—Ü–∏—è: get_calculator_registry()
```python
def get_calculator_registry(solver, precision=3) -> Dict[str, AnswerCalculator]:
    return {
        "current": CurrentCalculator(solver, precision),
        "voltage": VoltageCalculator(solver, precision),
        ...
    }
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** 
- –û—Ç–¥–µ–ª—è–µ—Ç –ª–æ–≥–∏–∫—É –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –æ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –≤–æ–ø—Ä–æ—Å–æ–≤
- Clean Code: –∫–∞–∂–¥—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä - –æ–¥–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

---

### 3. generator.py (–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ü–µ–ø–µ–π)

#### –ö–ª–∞—Å—Å: CircuitGenerator
```python
class CircuitGenerator:
    def __init__(self):
        self.difficulty_configs = {
            1: {min: 2, max: 2, topology: "series"},
            2: {min: 3, max: 3, topology: "series"},
            3: {min: 2, max: 3, topology: "parallel"},
            ...
            10: {min: 7, max: 10, topology: "complex"}
        }
```

**–ú–µ—Ç–æ–¥—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:**
```python
generate_circuit(difficulty, seed) ‚Üí (Circuit, question_type, metadata)
    ‚îú‚îÄ _generate_series()      # 2-3 —Ä–µ–∑–∏—Å—Ç–æ—Ä–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
    ‚îú‚îÄ _generate_parallel()    # 2-4 —Ä–µ–∑–∏—Å—Ç–æ—Ä–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
    ‚îú‚îÄ _generate_mixed()       # 3-4 —Ä–µ–∑–∏—Å—Ç–æ—Ä–∞ —Å–º–µ—à–∞–Ω–Ω–æ
    ‚îî‚îÄ _generate_complex()     # 4-10 —Ä–µ–∑–∏—Å—Ç–æ—Ä–æ–≤ –º–Ω–æ–≥–æ–∫–æ–Ω—Ç—É—Ä–Ω–æ
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
```python
_validate_circuit(circuit, nodes) ‚Üí bool
    ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ä–µ–∑–∏—Å—Ç–æ—Ä–æ–≤
    ‚îú‚îÄ _is_connected_circuit()      # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–Ω–æ—Å—Ç–∏
    ‚îú‚îÄ solver.solve()                # –ü–æ–ø—ã—Ç–∫–∞ —Ä–µ—à–∏—Ç—å
    ‚îî‚îÄ _has_current_in_circuit()    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–∞
```

**Seed –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏:**
```python
if seed is not None:
    random.seed(seed)
# –í—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ random.choice/randint –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω—ã
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ –ö–û–†–†–ï–ö–¢–ù–´–• —Å–ª—É—á–∞–π–Ω—ã—Ö —Ü–µ–ø–µ–π

---

### 4. prompt.py (–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

#### –§—É–Ω–∫—Ü–∏—è: create_circuit_prompt()
```python
def create_circuit_prompt(
    metadata: dict,
    question_type: str,
    target_resistor: str
) -> str:
    # 1. –†–æ–ª—å: "You are an expert..."
    # 2. –ó–∞–∫–æ–Ω—ã —Ñ–∏–∑–∏–∫–∏ (–û–º–∞, –ö–∏—Ä—Ö–≥–æ—Ñ–∞)
    # 3. –û–ø–∏—Å–∞–Ω–∏–µ —Ü–µ–ø–∏
    # 4. –í–æ–ø—Ä–æ—Å
    # 5. –§–æ—Ä–º–∞—Ç: <think>...</think><answer>X.XXX</answer>
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–º–ø—Ç–∞:**
```
You are an expert circuit analysis engineer.
Solve electrical circuit problems using physics laws.

FUNDAMENTAL LAWS:
1. Ohm: V=IR, I=V/R
2. KCL: Œ£I_in=Œ£I_out
3. KVL: Œ£V=0
4. Series: R_total=R‚ÇÅ+R‚ÇÇ+..., I_total=I‚ÇÅ=I‚ÇÇ
5. Parallel: 1/R_total=1/R‚ÇÅ+1/R‚ÇÇ+..., V_total=V‚ÇÅ=V‚ÇÇ
6. Power: P=I¬≤R=V¬≤/R

Circuit: Series circuit with V=10V, R1=100Œ©, R2=200Œ©

Question: Find the current through R1 (in Amperes)

YOU MUST USE THE FOLLOWING FORMAT:
<think>Your step-by-step reasoning</think>
<answer>X.XXX</answer>

PROVIDE ANSWER WITH EXACTLY 3 DECIMAL PLACES, NO UNITS.
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ –∑–∞–∫–æ–Ω–∞–º–∏

---

### 5. verifier.py (–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ—Ü–µ–Ω–∫–∞)

#### –ö–ª–∞—Å—Å: DCCircuitVerifier
```python
class DCCircuitVerifier(Verifier):
    def __init__(self):
        self.rtol = 1e-3      # 0.1% –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å
        self.atol = 1e-6      # 1Œº –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å
        self.precision = 3    # 3 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
```

**–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–π –æ—Ü–µ–Ω–∫–∏:**
```python
THRESHOLD_PERFECT = 0.001  # 0.1% ‚Üí score 1.0
THRESHOLD_GOOD = 0.002     # 0.2% ‚Üí score 0.75
THRESHOLD_OK = 0.003       # 0.3% ‚Üí score 0.5
THRESHOLD_FAIR = 0.005     # 0.5% ‚Üí score 0.25
# > 0.5% ‚Üí score 0.0
```

**–ú–µ—Ç–æ–¥—ã:**

1. **verify(data, test_answer) ‚Üí bool**
```python
# –ò–∑–≤–ª–µ—á—å –æ—Ç–≤–µ—Ç
extracted = extract_answer(test_answer)

# –û–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ precision
rounded_correct = round(correct, 3)
rounded_agent = round(agent, 3)

# –ü—Ä–æ–≤–µ—Ä–∫–∞:
|agent - correct| <= atol + rtol * |correct|
```

2. **get_accuracy_score(data, test_answer) ‚Üí float [0.0-1.0]**
```python
# –í—ã—á–∏—Å–ª–∏—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—É—é –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å
rel_error = |agent - correct| / |correct|

# –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞:
if rel_error <= 0.001: return 1.0
elif rel_error <= 0.002: return 0.75
elif rel_error <= 0.003: return 0.5
elif rel_error <= 0.005: return 0.25
else: return 0.0
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** 
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–æ–≤
- –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–µ rewards –¥–ª—è GRPO (–Ω–µ –±–∏–Ω–∞—Ä–Ω–æ!)
- –ï–¥–∏–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤

---

### 6. game.py (–ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä)

#### –ö–ª–∞—Å—Å: DCCircuitGame
```python
class DCCircuitGame(Game):
    def __init__(self):
        super().__init__("DC Circuit Analysis", DCCircuitVerifier)
        self.generator = CircuitGenerator()
        self.solver = CircuitSolver()
        self.answer_precision = 3
```

**–ú–µ—Ç–æ–¥ generate():**
```python
def generate(
    num_of_questions=100,
    max_attempts=50,
    difficulty=1,
    seed=None
) -> List[Data]:
    
    for _ in range(num_of_questions):
        # 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ü–µ–ø–∏
        circuit, question_type, metadata = self.generator.generate_circuit(
            difficulty=difficulty,
            seed=seed
        )
        
        # 2. –†–µ—à–µ–Ω–∏–µ —Ü–µ–ø–∏
        node_voltages = self.solver.solve(circuit)
        
        # 3. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ (Strategy Pattern)
        answer = self._calculate_answer(
            circuit,
            node_voltages,
            metadata,
            question_type,
            target_resistor
        )
        
        # 4. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞
        question = create_circuit_prompt(
            metadata,
            question_type,
            target_resistor
        )
        
        # 5. –í–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö
        yield Data(
            question=question,
            answer=str(answer),
            difficulty=difficulty,
            metadata=metadata
        )
```

**–ú–µ—Ç–æ–¥ _calculate_answer():**
```python
def _calculate_answer(...) -> float:
    # –õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–≤
    if not hasattr(self, '_calculators'):
        self._calculators = get_calculator_registry(
            self.solver,
            self.answer_precision
        )
    
    # Strategy Pattern
    calculator = self._calculators[question_type]
    return calculator.calculate(...)
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** 
- –ï–î–ò–ù–ê–Ø –¢–û–ß–ö–ê –í–•–û–î–ê –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–∞–¥–∞—á
- –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
- –°–∫—Ä—ã–≤–∞–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–æ–¥—É–ª–µ–π

### –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    DCCircuitGame.generate()                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                         ‚îÇ
        ‚ñº                         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ CircuitGenerator  ‚îÇ    ‚îÇ   CircuitSolver   ‚îÇ
‚îÇ .generate_circuit ‚îÇ    ‚îÇ     .solve()      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                        ‚îÇ
         ‚îÇ Circuit                ‚îÇ node_voltages
         ‚îÇ                        ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
                      ‚ñº
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ  _calculate_answer  ‚îÇ
           ‚îÇ  (Strategy Pattern) ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
                      ‚ñº
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ   calculators[type] ‚îÇ
           ‚îÇ     .calculate()    ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
                      ‚ñº
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ create_circuit_prompt‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
                      ‚ñº
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ   Data(question,    ‚îÇ
           ‚îÇ   answer, metadata) ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–∏–º–µ—Ä: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–¥–∞—á–∏ –æ —Ç–æ–∫–µ

```python
# –®–ê–ì 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ü–µ–ø–∏
circuit, question_type, metadata = generator.generate_circuit(difficulty=2)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
circuit = Circuit()
circuit.add_voltage_source("A", "C", 10)  # 10V
circuit.add_resistor("A", "B", 100)       # R1=100Œ©
circuit.add_resistor("B", "C", 200)       # R2=200Œ©
circuit.set_ground("C")

question_type = "current"
target_resistor = "R1"

# –®–ê–ì 2: –†–µ—à–µ–Ω–∏–µ —Ü–µ–ø–∏
node_voltages = solver.solve(circuit)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: {"A": 10.0, "B": 6.667, "C": 0.0}

# –®–ê–ì 3: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
calculator = calculators["current"]  # CurrentCalculator
answer = calculator.calculate(circuit, node_voltages, metadata, "R1")

# CurrentCalculator –¥–µ–ª–∞–µ—Ç:
n1, n2 = "A", "B"  # –£–∑–ª—ã R1
V1 = node_voltages["A"] = 10.0
V2 = node_voltages["B"] = 6.667
R = 100
I = (V1 - V2) / R = (10.0 - 6.667) / 100 = 0.033
answer = round(abs(I), 3) = 0.033

# –®–ê–ì 4: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞
question = create_circuit_prompt(metadata, "current", "R1")

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
"""
You are an expert...
FUNDAMENTAL LAWS: ...
Circuit: Series circuit with V=10V, R1=100Œ©, R2=200Œ©
Question: Find the current through R1 (in Amperes)
...
"""

# –®–ê–ì 5: –í–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö
data = Data(
    question=question,
    answer="0.033",
    difficulty=2,
    metadata=metadata
)
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ rl_trainer.py

### –ö–ª–∞—Å—Å: DCCircuitDataset

```python
class DCCircuitDataset(Dataset):
    def __init__(self, config: TrainingConfig):
        self.game = DCCircuitGame()  # ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ—Ç game
        self.config = config
    
    def _generate_data(self) -> List[dict]:
        for difficulty in self.config.difficulties:
            # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ game
            data_list = self.game.generate(
                num_of_questions=self.config.samples_per_difficulty,
                difficulty=difficulty
            )
            
            # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è GRPO
            for data in data_list:
                yield {
                    "prompt": [
                        {"role": "user", 
                         "content": f"{data.question}\n<gold>{data.answer}</gold>"}
                    ],
                    "answer": f"{float(data.answer):.3f}"
                }
```

**–í–∞–∂–Ω–æ:** –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è `<gold>{answer}</gold>` –¥–ª—è reward function

### –ö–ª–∞—Å—Å: DCCircuitRLTrainer

#### reward_function()

```python
def reward_function(self, prompts, completions, **kwargs) -> List[float]:
    # 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è verifier
    if self._verifier is None:
        self._verifier = DCCircuitVerifier()  # ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ—Ç verifier
    
    # 2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤
    responses = self._normalize_completions(completions)
    
    # 3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö —à–∞–≥–∞—Ö)
    step = self._get_step(kwargs)
    if self._should_log_step(step):
        self._log_detailed_metrics(...)
    
    # 4. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
    prompt_content = self._extract_prompt_content(prompts)
    correct_answer = self._extract_gold_answer(prompt_content)
    # –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏–∑ <gold>...</gold>
    
    # 5. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ rewards
    return self._calculate_rewards(correct_answer, responses)
```

#### _calculate_rewards()

```python
def _calculate_rewards(correct_answer, responses) -> List[float]:
    data = Data(question="", answer=correct_answer, ...)
    rewards = []
    
    for response in responses:
        # –í—ã–∑–æ–≤ verifier (–ù–ï –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏!)
        accuracy_score = self._verifier.get_accuracy_score(data, response)
        
        # Reward = accuracy * 2.0
        reward = accuracy_score * 2.0
        rewards.append(reward)
    
    return rewards
```

**–í–∞–∂–Ω–æ:** 
- Trainer –ù–ï –¥—É–±–ª–∏—Ä—É–µ—Ç –ª–æ–≥–∏–∫—É verifier
- –í—ã–∑—ã–≤–∞–µ—Ç `verifier.get_accuracy_score()`
- SINGLE SOURCE OF TRUTH!

### –ü–æ–ª–Ω—ã–π –ø–æ—Ç–æ–∫ GRPO –æ–±—É—á–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  1. DCCircuitDataset                    ‚îÇ
‚îÇ     ‚îú‚îÄ DCCircuitGame.generate()         ‚îÇ
‚îÇ     ‚îî‚îÄ –î–æ–±–∞–≤–ª—è–µ—Ç <gold>{answer}</gold>  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  2. GRPOTrainer.train()                 ‚îÇ
‚îÇ     ‚îú‚îÄ –ú–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç—ã        ‚îÇ
‚îÇ     ‚îî‚îÄ –í—ã–∑—ã–≤–∞–µ—Ç reward_function()       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  3. reward_function()                   ‚îÇ
‚îÇ     ‚îú‚îÄ –ò–∑–≤–ª–µ–∫–∞–µ—Ç <gold> –∏–∑ –ø—Ä–æ–º–ø—Ç–∞     ‚îÇ
‚îÇ     ‚îú‚îÄ –ò–∑–≤–ª–µ–∫–∞–µ—Ç <answer> –∏–∑ –æ—Ç–≤–µ—Ç–∞    ‚îÇ
‚îÇ     ‚îî‚îÄ DCCircuitVerifier.get_accuracy   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  4. DCCircuitVerifier                   ‚îÇ
‚îÇ     ‚îú‚îÄ –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã               ‚îÇ
‚îÇ     ‚îú‚îÄ –í—ã—á–∏—Å–ª—è–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—É—é –æ—à–∏–±–∫—É  ‚îÇ
‚îÇ     ‚îî‚îÄ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç score [0.0-1.0]      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  5. GRPO –æ–±–Ω–æ–≤–ª—è–µ—Ç –º–æ–¥–µ–ª—å               ‚îÇ
‚îÇ     ‚îî‚îÄ –ù–∞ –æ—Å–Ω–æ–≤–µ rewards                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### MEDIUM Priority

#### 1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ type hints –≤ dc_circuit/

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# base/ - 100% type hints ‚úÖ
def extract_answer(solution: str) -> Optional[str]:
    ...

# dc_circuit/ - —á–∞—Å—Ç–∏—á–Ω–æ ‚ùå
def generate_circuit(self, difficulty=1, seed=None):  # –ù–µ—Ç —Ç–∏–ø–æ–≤ –≤–æ–∑–≤—Ä–∞—Ç–∞
    ...
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
def generate_circuit(
    self, 
    difficulty: int = 1, 
    seed: Optional[int] = None
) -> Tuple[Circuit, str, Dict[str, Any]]:
    ...
```

#### 2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ unit —Ç–µ—Å—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–æ–ª—å–∫–æ main.py —Å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–µ–π

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å tests/
```
tests/
‚îú‚îÄ‚îÄ test_solver.py          # –¢–µ—Å—Ç—ã —Ä–µ—à–µ–Ω–∏—è —Ü–µ–ø–µ–π
‚îú‚îÄ‚îÄ test_calculators.py     # –¢–µ—Å—Ç—ã –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–≤
‚îú‚îÄ‚îÄ test_generator.py       # –¢–µ—Å—Ç—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ test_verifier.py        # –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏
```

### LOW Priority

3. prompt.py - —Ñ—É–Ω–∫—Ü–∏—è, –∞ –Ω–µ –∫–ª–∞—Å—Å
4. Magic numbers –≤ generator.py
5. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
6. Hardcoded chat template
7. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ logging

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ

1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** 9/10
   - –ß–∏—Å—Ç–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
   - Strategy Pattern –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—ë–Ω
   - –ù–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

2. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:** 10/10
   - –í–µ–∑–¥–µ precision = 3
   - –ï–¥–∏–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è extract_answer()
   - Verifier –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ
   - Reward consistency (trainer ‚Üí verifier)

3. **–§–∏–∑–∏–∫–∞:** 10/10
   - –£—Ä–∞–≤–Ω–µ–Ω–∏—è –ö–∏—Ä—Ö–≥–æ—Ñ–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ—à–∞—é—Ç—Å—è
   - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–ø–µ–π –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
   - –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–µ rewards (–Ω–µ –±–∏–Ω–∞—Ä–Ω—ã–µ!)

### üîß –ß—Ç–æ —É–ª—É—á—à–∏—Ç—å

1. **Type hints** (MEDIUM)
   - –î–æ–±–∞–≤–∏—Ç—å –≤–æ –≤—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã dc_circuit/
   - –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å base/

2. **Unit —Ç–µ—Å—Ç—ã** (MEDIUM)
   - pytest —Å coverage
   - –¢–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è

3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** (LOW)
   - –î–∏–∞–≥—Ä–∞–º–º—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
   - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è

### üö´ –ß—Ç–æ –ù–ï —Ç—Ä–æ–≥–∞—Ç—å

1. –°—Ç—Ä—É–∫—Ç—É—Ä—É –º–æ–¥—É–ª–µ–π (–æ—Ç–ª–∏—á–Ω–∞—è!)
2. Strategy pattern (–ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—ë–Ω)
3. Solver/Calculator —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ (—á–∏—Å—Ç–æ–µ)
4. Reward consistency (trainer ‚Üí verifier)

---

## –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|--------|-------------|
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | 9/10 | –ß–∏—Å—Ç–∞—è, —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è |
| –ö–æ–¥ | 7.8/10 | –ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 8/10 | –•–æ—Ä–æ—à–∏–π README |
| –¢–µ—Å—Ç—ã | 3/10 | –¢–æ–ª—å–∫–æ demo |
| –§–∏–∑–∏–∫–∞ | 10/10 | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è |
| **–ò–¢–û–ì–û** | **7.6/10** | **–ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É** |

### –í—ã–≤–æ–¥—ã

1. ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ **–û–¢–õ–ò–ß–ù–ê–Ø** - –º–æ–¥—É–ª—å–Ω–∞—è, —á–∏—Å—Ç–∞—è, —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è
2. ‚úÖ –ö–æ–¥ **–ö–ê–ß–ï–°–¢–í–ï–ù–ù–´–ô** - –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ DRY, —á–∏—Ç–∞–µ–º—ã–π
3. ‚úÖ –§–∏–∑–∏–∫–∞ **–ö–û–†–†–ï–ö–¢–ù–ê–Ø** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
4. ‚ö†Ô∏è  –¢–µ—Å—Ç—ã **–û–¢–°–£–¢–°–¢–í–£–Æ–¢** - –Ω—É–∂–Ω—ã unit —Ç–µ—Å—Ç—ã
5. ‚ö†Ô∏è  Type hints **–ß–ê–°–¢–ò–ß–ù–û** - –Ω—É–∂–Ω–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é, –Ω–æ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å type hints –∏ unit —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞.
